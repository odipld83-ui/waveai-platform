{% extends "base.html" %}

{% block title %}Dashboard - {{ user.name }} | WaveAI{% endblock %}

{% block nav %}
<span style="opacity: 0.8;">Bienvenue, <strong>{{ user.name }}</strong></span>
<button class="btn" onclick="logout()" style="background: rgba(255,255,255,0.1);">
    🚪 Déconnexion
</button>
{% endblock %}

{% block content %}
<div style="text-align: center; margin-bottom: 50px;">
    <div style="width: 80px; height: 80px; border-radius: 50%; background: {{ user.avatar_color }}; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; font-size: 2em;">
        🌊
    </div>
    <h1 style="font-size: 2.5em; margin-bottom: 10px;">
        Bonjour {{ user.name }} ! 👋
    </h1>
    <p style="font-size: 1.2em; opacity: 0.8;">
        Choisissez votre agent WaveAI pour commencer
    </p>
</div>

<!-- Configuration IA -->
<div style="text-align: center; margin-bottom: 30px;">
    <a href="/ai-settings" class="btn" style="background: rgba(16, 185, 129, 0.2); border-color: #10b981;">
        ⚙️ Configuration IA
    </a>
</div>

<div class="agent-grid">
    <div class="agent-card" onclick="location.href='/agents/alex'">
        <div class="agent-icon">🏄‍♂️</div>
        <div class="agent-name">Alex Wave</div>
        <div class="agent-desc">
            <strong>Gmail & Productivité</strong><br>
            Votre expert en gestion d'emails et optimisation du workflow. 
            Organisez, automatisez, et maximisez votre efficacité.
        </div>
        <div class="btn btn-primary">💬 Chatter avec Alex</div>
    </div>
    
    <div class="agent-card" onclick="location.href='/agents/lina'">
        <div class="agent-icon">🌊</div>
        <div class="agent-name">Lina Wave</div>
        <div class="agent-desc">
            <strong>LinkedIn & Networking</strong><br>
            Spécialiste en développement professionnel et stratégies LinkedIn. 
            Développez votre réseau et votre influence.
        </div>
        <div class="btn btn-primary">💬 Chatter avec Lina</div>
    </div>
    
    <div class="agent-card" onclick="location.href='/agents/marco'">
        <div class="agent-icon">🏄‍♀️</div>
        <div class="agent-name">Marco Wave</div>
        <div class="agent-desc">
            <strong>Réseaux Sociaux</strong><br>
            Expert en création de contenu viral et stratégies social media. 
            Boostez votre présence en ligne.
        </div>
        <div class="btn btn-primary">💬 Chatter avec Marco</div>
    </div>
    
    <div class="agent-card" onclick="location.href='/agents/sofia'">
        <div class="agent-icon">🌊</div>
        <div class="agent-name">Sofia Wave</div>
        <div class="agent-desc">
            <strong>Calendrier & Planning</strong><br>
            Maître de l'organisation et gestionnaire de temps. 
            Planifiez, synchronisez, et optimisez votre agenda.
        </div>
        <div class="btn btn-primary">💬 Chatter avec Sofia</div>
    </div>
    
    <div class="agent-card" onclick="location.href='/agents/kai'">
        <div class="agent-icon">🤖</div>
        <div class="agent-name">Kai Wave</div>
        <div class="agent-desc">
            <strong>Assistant Conversationnel</strong><br>
            Votre compagnon IA pour discussions libres, questions générales, 
            conseils personnels et exploration d'idées.
        </div>
        <div class="btn btn-primary">💬 Chatter avec Kai</div>
    </div>
</div>

<div class="glass" style="text-align: center; margin-top: 50px; background: rgba(255,255,255,0.1);">
    <h3 style="margin-bottom: 15px;">📊 Vos Statistiques</h3>
    <div id="userStats" style="opacity: 0.8;">
        Chargement de vos données...
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Charger les statistiques utilisateur
async function loadUserStats() {
    try {
        const response = await fetch('/api/user/stats');
        const data = await response.json();
        
        if (data.success) {
            const statsHtml = `
                <p><strong>Membre depuis :</strong> ${data.user.member_since}</p>
                <p><strong>Dernière connexion :</strong> ${data.user.last_login}</p>
                <p><strong>Messages envoyés :</strong> ${data.stats.total_messages}</p>
                <div style="margin-top: 15px;">
                    <small>Alex: ${data.stats.agents_usage.alex} | Lina: ${data.stats.agents_usage.lina} | Marco: ${data.stats.agents_usage.marco} | Sofia: ${data.stats.agents_usage.sofia} | Kai: ${data.stats.agents_usage.kai}</small>
                </div>
            `;
            document.getElementById('userStats').innerHTML = statsHtml;
        }
    } catch (error) {
        document.getElementById('userStats').innerHTML = '<p>Statistiques non disponibles</p>';
    }
}

// Fonction de déconnexion
async function logout() {
    try {
        await fetch('/api/auth/logout', { method: 'POST' });
        window.location.href = '/';
    } catch (error) {
        window.location.href = '/';
    }
}

// Charger les stats au chargement de la page
document.addEventListener('DOMContentLoaded', loadUserStats);

// Animation d'entrée
document.querySelectorAll('.agent-card').forEach((card, index) => {
    card.style.opacity = '0';
    card.style.transform = 'translateY(30px)';
    
    setTimeout(() => {
        card.style.transition = 'all 0.6s ease';
        card.style.opacity = '1';
        card.style.transform = 'translateY(0)';
    }, index * 150);
});
</script>
{% endblock %}

